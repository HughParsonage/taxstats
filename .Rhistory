sample_file_1213 %>%
grplot(aes(x = Taxable_Income, fill = Net_rent_amt < 0)) +
geom_density(alpha = 0.5) +
scale_x_continuous(limits = c(0, 200e3))
sample_file_1213 %>%
grplot() +
geom_density(aes(x = Taxable_Income, fill = Net_rent_amt < 0), alpha = 0.5) +
geom_density(aes(x = Taxable_Income - pmin(Net_rent_amt, 0))) +
scale_x_continuous(limits = c(0, 200e3))
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(n_NG = mean(Net_rent_amt < 0)) %>%
ggplot(aes(x = factor(Taxable_Income_decile), y = n_NG)) +
geom_bar(stat = "identity", width = 0.9)
dplyr::bind_rows
?`%||%`
library(dplyr)
?`%||%`
?dplyr:::`%||%`
??`%||%
`
5 %||% 5
dplyr:::%||%
`dplyr:::%||%`
dplyr:::`%||%`
bind_rows
.id2 <- c("before", "after")
get_dots <- function(...){
dots.char <- quote(list(...))
dots.char
}
x <- 1
y <- 2
get_dots(x, y)
get_dots <- function(...){
dots <- list(...)
dots
}
get_dots(x, y)
get_dots <- function(...){
dots <- list(...)
names(dots) <- list(...)
dots
}
get_dots(x, y)
?object
?quote
substitute(x, y)
all.names(expression(sin(x+y)))
get_dots <- function(...){
all.names(expression(...))
}
get_dots(x, y)
get_dots <- function(...){
all.names(expression(list(...)))
}
get_dots(x, y)
get_dots <- function(...){
all.vars(...)
}
get_dots(x, y)
get_dots <- function(...){
all.names(call(list(...)))
}
get_dots(x, y)
get_dots <- function(...){
all.names(call(as.character(list(...))))
}
get_dots(x, y)
get_dots <- function(a, ...) {
arg <- deparse(substitute(a))
dots <- substitute(list(...))[-1]
c(arg, sapply(dots, deparse))
}
get_dots(x, x, y)
rep(c("x", "y"), c(2, 3))
Bind_Rows <- function(..., .id = NULL, .id2 = NULL){
dots <- list(...)
if (is.list(dots[[1]]) && !is.data.frame(dots[[1]]) && !length(dots[-1])) {
x <- dots[[1]]
} else {
x <- dots
}
if (!(is.null(.id) || is.null(.id2))){
stop("One of .id and .id2 must be NULL")
}
if (!is.null(.id)) {
if (!(is.character(.id) && length(.id) == 1)) {
stop(".id is not a string", call. = FALSE)
}
names(x) <- names(x) %||% seq_along(x)
}
out <- rbind_all(x, .id)
if (!is.null(.id2)){
nrows <- lapply(x, nrow)
dots_names <- function(a, ...) {
arg <- deparse(substitute(a))
dots <- substitute(list(...))[-1]
c(arg, sapply(dots, deparse))
}
out$id2 <- rep(x = dots_names(...), nrows)
}
out
}
ab <- data_frame(x = 1:5, y = 1:5)
cd <- data_frame(x = 10:12, y = 20:22)
Bind_Rows(ab, cd)
Bind_Rows(ab, cd, id2 = TRUE)
rbind(ab, cd)
out <- rbind(ab, cd)
out$id2 <- 1
out
Bind_Rows(ab, cd, .id2 = TRUE)
Bind_Rows(ab, cd, .id = c("ab", "cd"))
?stop
?rbind_all
rbind_all
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
ggplot(aes(x = factor(Taxable_Income_decile), y = n_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9)
taxable_income <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(n_NG = mean(Net_rent_amt < 0))
before_deductions <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt < 0), 10)) %>%
summarise(n_NG = mean(Net_rent_amt < 0))
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
ggplot(aes(x = factor(Taxable_Income_decile), y = n_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9)
library(taxstats)
library(magrittr)
library(grattan)
taxable_income <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(n_NG = mean(Net_rent_amt < 0))
before_deductions <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt < 0), 10)) %>%
summarise(n_NG = mean(Net_rent_amt < 0))
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
ggplot(aes(x = factor(Taxable_Income_decile), y = n_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9)
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
grplot(aes(x = factor(Taxable_Income_decile), y = n_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9)
traceback()
library(ggplot2)
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
grplot(aes(x = factor(Taxable_Income_decile), y = n_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9)
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
grplot(aes(x = factor(Taxable_Income_decile), y = n_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9) +
facet_grid(~before_after)
taxable_income <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(n_NG = sum(Net_rent_amt < 0)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(NG))
before_deductions <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt < 0), 10)) %>%
summarise(n_NG = sum(Net_rent_amt < 0)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(NG))
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
grplot(aes(x = factor(Taxable_Income_decile), y = prop_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9) +
facet_grid(~before_after)
taxable_income <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(n_NG = sum(Net_rent_amt < 0)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(n_NG))
before_deductions <-
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt < 0), 10)) %>%
summarise(n_NG = sum(Net_rent_amt < 0)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(n_NG))
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
grplot(aes(x = factor(Taxable_Income_decile), y = prop_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9) +
facet_grid(~before_after)
taxable_income
before_deductions
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>% arrange(Taxable_Income_decile)
sample_file_1213 %>% mutate(Taxable_Income_decile = ntile(Taxable_Income, 10), other_Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %$% mean(Taxable_Income != Taxable_Income_decile)
sample_file_1213 %>% mutate(Taxable_Income_decile = ntile(Taxable_Income, 10), other_Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %$% mean(other_Taxable_Income_decile != Taxable_Income_decile)
sample_file_1213 %>% mutate(Taxable_Income_decile = ntile(Taxable_Income, 10), other_Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %$% mean(Net_rent_amt < 0)
sample_file_1213 %>% group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(min = min(Taxable_Income), max = max(Taxable_Income))
sample_file_1213 %>% group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(min = min(Taxable_Income) - max(Taxable_Income))
sample_file_1213 %>% group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
mutate(min = min(Taxable_Income) - max(Taxable_Income)) %>% summarise(n = sum(Net_rent_amt < min))
sample_file_1213 %>% group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
mutate(min = min(Taxable_Income) - max(Taxable_Income)) %>% group_by(Taxable_Income_decile) %>% summarise(n = sum(Net_rent_amt < min))
sample_file_1213 %>% group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
mutate(min = min(Taxable_Income) - max(Taxable_Income)) %>% group_by(Taxable_Income_decile) %>% summarise(n = sum(Net_rent_amt < min), n = sum(Net_rent_amt < 0))
sample_file_1213 %>% group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
mutate(min = min(Taxable_Income) - max(Taxable_Income)) %>% group_by(Taxable_Income_decile) %>% summarise(n = sum(Net_rent_amt < min), n = sum(Net_rent_amt < 0), mean(Net_rent_amt))
sample_file_1213 %>% group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
mutate(min = min(Taxable_Income) - max(Taxable_Income)) %>% group_by(Taxable_Income_decile) %>% summarise(n = sum(Net_rent_amt < min), n = sum(Net_rent_amt < 0), mean(Net_rent_amt[Net_rent_amt < 0]))
sample_file_1213 %>% mutate(Taxable_Income_decile = ntile(Taxable_Income, 10), Taxable_Income_decile2 = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %>% filter(Taxable_Income_decile != Taxable_Income_decile2)
sum(sample_file_1213$Net_rent_amt <0)
sample_file_1213 %>% mutate(Taxable_Income_decile = ntile(Taxable_Income, 10), Taxable_Income_decile2 = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %>% filter(Taxable_Income_decile != Taxable_Income_decile2) %$% sum(Taxable_Income_decile == 2)
sample_file_1213 %>% mutate(Taxable_Income_decile = ntile(Taxable_Income, 10), Taxable_Income_decile2 = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %>% filter(Taxable_Income_decile != Taxable_Income_decile2) %$% sum(Taxable_Income_decile2 == 2)
sample_file_1213 %>% mutate(Taxable_Income_decile = ntile(Taxable_Income, 10), Taxable_Income_decile2 = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %>% filter(Taxable_Income_decile != Taxable_Income_decile2) %>% arrange(Taxable_Income_decile)
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after")
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt < 0), 10)) %>% summarise(diff = max(Taxable_Income - pmin(Net_rent_amt, 0)) - min(Taxable_Income - pmin(Net_rent_amt, 0)))
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt < 0), 10)) %>% summarise(diff = max(Taxable_Income - pmin(Net_rent_amt, 0)) - min(Taxable_Income - pmin(Net_rent_amt, 0)), max(Taxable_Income - pmin(Net_rent_amt, 0)))
sample_file_1213 %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income - pmin(Net_rent_amt, 0), 10)) %>% summarise(diff = max(Taxable_Income - pmin(Net_rent_amt, 0)) - min(Taxable_Income - pmin(Net_rent_amt, 0)), max(Taxable_Income - pmin(Net_rent_amt, 0)))
sample_file_1213 %>% mutate(Taxable_Income_pre = Taxable_Income - pmin(Net_rent_amt, 0)) %>% group_by(decile = ntile(Taxable_Income_pre, 10)) %>% summarise(n())
sample_file_1213 %>% mutate(Taxable_Income_pre = Taxable_Income - pmin(Net_rent_amt, 0)) %>% group_by(decile = ntile(Taxable_Income_pre, 10)) %>% summarise(sum(Net_rent_amt < 0))
before_deductions <-
sample_file_1213 %>%
mutate(Taxable_Income_pre = Taxable_Income - pmin(Net_rent_amt, 0)) %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income_pre, 10))%>%
summarise(n_NG = sum(Net_rent_amt < 0)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(n_NG))
before_deductions
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
grplot(aes(x = factor(Taxable_Income_decile), y = prop_NG, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9) +
facet_grid(~before_after)
taxable_income <-
sample_file_1213 %>%
mutate(tax = income_tax(Taxable_Income),
tax_pre = income_tax(Taxable_Income_pre)) %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(n_NG = sum(Net_rent_amt < 0),
diff = sum(tax_pre - tax)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(n_NG),
prop_diff = diff / sum(diff))
before_deductions <-
sample_file_1213 %>%
mutate(Taxable_Income_pre = Taxable_Income - pmin(Net_rent_amt, 0)) %>%
mutate(tax = income_tax(Taxable_Income),
tax_pre = income_tax(Taxable_Income_pre)) %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income_pre, 10))%>%
summarise(n_NG = sum(Net_rent_amt < 0),
diff = sum(tax_pre - tax)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(n_NG),
prop_diff = diff / sum(diff))
taxable_income <-
sample_file_1213 %>%
mutate(Taxable_Income_pre = Taxable_Income - pmin(Net_rent_amt, 0)) %>%
mutate(tax = income_tax(Taxable_Income),
tax_pre = income_tax(Taxable_Income_pre)) %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income, 10)) %>%
summarise(n_NG = sum(Net_rent_amt < 0),
diff = sum(tax_pre - tax)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(n_NG),
prop_diff = diff / sum(diff))
before_deductions <-
sample_file_1213 %>%
mutate(Taxable_Income_pre = Taxable_Income - pmin(Net_rent_amt, 0)) %>%
mutate(tax = income_tax(Taxable_Income),
tax_pre = income_tax(Taxable_Income_pre)) %>%
group_by(Taxable_Income_decile = ntile(Taxable_Income_pre, 10))%>%
summarise(n_NG = sum(Net_rent_amt < 0),
diff = sum(tax_pre - tax)) %>%
ungroup %>%
mutate(prop_NG = n_NG / sum(n_NG),
prop_diff = diff / sum(diff))
bind_rows("Taxable income" = taxable_income,
"Before deductions" = before_deductions, .id = "before_after") %>%
grplot(aes(x = factor(Taxable_Income_decile), y = prop_diff, fill = before_after)) +
geom_bar(stat = "identity", width = 0.9) +
facet_grid(~before_after)
library(taxstats)
library(grattan)
library(magrittr)
sample_file_1213 %$%
sum(income_tax(Taxable_Income)) * 50
sample_file_1213 %$%
sum(grattan:::.income_tax(Taxable_Income)) * 50
sample_file_1213 %$%
sum(grattan:::.income_tax(Taxable_Income, "2012-13")) * 50
grattan:::.income_tax
87680726006/1e9
87*2
grattan:::.income_tax(50e3, "2012-13")
income_tax(50e3)
remove.packages("grattan")
devtools::install_github("HughParsonage/grattan")
library(grattan)
grattan:::.income_tax(50e3, "2012-13")
library(taxstats)
project(sample_file_1213, 1L)
library(taxstats)
project(sample_file_1213, 1L)
library(taxstats)
project(sample_file_1213, 1L)
x <- .Last.value
x
plot(density(sample_file_1213$Taxable_Income))
plot(density(sample_file_1213$Taxable_Income, from = 0, to = 250e3))
plot(density(sample_file_1213$Taxable_Income, from = 0, to = 250e3))
lines(density(x$Taxable_Income, from = 0, to = 250e3), col = 2, lwd = 2)
plot(density(sample_file_1213$Net_CG_amt, from = 0, to = 250e3))
lines(density(x$Taxable_Income, from = 1, to = 250e3), col = 2, lwd = 2)
plot(density(sample_file_1213$Net_CG_amt, from = 1, to = 250e3))
plot(density(sample_file_1213$Net_CG_amt[sample_file_1213$Net_CG_amt > 0], from = 0, to = 250e3))
hist(sample_file_1213$Net_CG_amt[sample_file_1213$Net_CG_amt > 0], from = 0, to = 250e3)
quantile(sample_file_1213$Net_CG_amt, probs = (0:10)/10)
quantile(sample_file_1213$Net_CG_amt[], probs = (90:100)/100)
quantile(sample_file_1213$Net_CG_amt[], probs = (950:1000)/1000)
plot(density(sample_file_1213[between(Net_CG_amt, 1, 10e6)], from = 0, to = 250e3))
library(dplyr)
library(data.table)
library(dplyr)
library(data.table)
plot(density(sample_file_1213[between(Net_CG_amt, 1, 10e6)], from = 0, to = 250e3))
plot(density(sample_file_1213[between(Net_CG_amt, 1, 10e6)]$Net_CG_amt, from = 0, to = 250e3))
plot(density(sample_file_1213[between(Net_CG_amt, 1, 10e6)]$Net_CG_amt))
plot(density(sample_file_1213$Net_rent_amt))
sample_file_1213 %>% filter(between(ntile(Net_rent_amt, 100), 5, 95)) %$% plot(density(.))
library(magrittr)
sample_file_1213 %>% filter(between(ntile(Net_rent_amt, 100), 5, 95)) %$% plot(density(.))
sample_file_1213 %>% filter(between(ntile(Net_rent_amt, 100), 5, 95)) %$% plot(density(Net_rent_amt))
sample_file_1213 %>% filter(between(ntile(Net_rent_amt, 100), 2, 95)) %$% plot(density(Net_rent_amt))
ggplot(NULL) + annotate("point", x = sample_file_1213$Net_rent_amt, y = x$Net_rent_amt)
library(ggplot2)
ggplot(NULL) + annotate("point", x = sample_file_1213$Net_rent_amt, y = x$Net_rent_amt)
ggplot(NULL) + annotate("point", x = sample_file_1213$Tot_inc_amt, y = x$Tot_inc_amt, alpha = 0.5) + theme_dark()
which.min(x$Tot_inc_amt)
x[.Last.value]
sample_file_1213[.Last.value]
sample_file_1213[Ind == 23161]
sample_file_1213[Ind == 23161][age_range_decoder]
sample_file_1213[Ind == 23161] %>% merge(age_range_decoder, by = "age_range")
x[Ind == 23161] %>% merge(age_range_decoder, by = "age_range")
log10(159528730)
sample_file_variable_names
occupation_decoder
region_decoder
x[Ind == 23161] %>% merge(age_range_decoder, by = "age_range")
sample_files_all %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt)) %$% plot(forecast::forecast(.))
sample_files_all %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt)) %$% plot(forecast::forecast(.))
sample_files_all %>% group_by(fy.year) %>% summarise(n()) %$% plot(forecast::forecast(.))
traceback()
sample_files_all %>% group_by(fy.year) %>% summarise(n()) %$% plot(forecast::forecast(ts(.)))
sample_files_all %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt)) %$% plot(forecast::forecast(ts(avg)))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt)) %$% plot(forecast::forecast(ts(avg)))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt)) %$% plot(forecast::forecast(auto.arima(avg)))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt)) %$% plot(forecast::forecast(forecast::auto.arima(avg)))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt), sd = sd(Net_rent_amt)) %$% plot(forecast::forecast(forecast::auto.arima(avg)))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt), sd = sd(Net_rent_amt))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt), sd = sd(Net_rent_amt)) %$% sd(avg)
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt), sd = sd(Net_rent_amt)) %$% (forecast::forecast(forecast::auto.arima(avg)))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt), sd = sd(Net_rent_amt)) %$% forecast::forecast(forecast::auto.arima(avg))
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt), sd = sd(Net_rent_amt)) %$% forecast::forecast(forecast::auto.arima(avg)) %>% str
?forecast
sample_files_all %>% filter(Net_rent_amt != 0L) %>% group_by(fy.year) %>% summarise(avg = mean(Net_rent_amt), sd = sd(Net_rent_amt)) %$% forecast::forecast(forecast::auto.arima(avg)) ->
x
x$mean %>% str
x$mean %>% names
magrittr::(x$mean, "mean")
magrittr::use_series(x$mean, "mean")
magrittr::use_series
x$mean$mean
x %>% magrittr::extract("mean")
x$level
x$upper
x %>% magrittr::extract("upper")
x %>% magrittr::use_series("upper")
x %>% magrittr::use_series("mean")
x %>% magrittr::use_series("mean") %>% as.numeric
x %>% magrittr::use_series("upper") %>% as.numeric
x %>% magrittr::use_series("lower") %>% as.numeric
x %>% magrittr::use_series("lower")
library(taxstats)
library(taxstats)
?project
?project_to
?generic_inflator
generic_inflator(sample_file_1213, "Sw_amt", h = 3L)
taxstats:::generic_inflator(sample_file_1213, "Sw_amt", h = 3L)
taxstats:::generic_inflator(sample_file_1213, vars = c("Sw_amt", "Taxable_Income"), h = 3L)
sample_files_all %>% select_(.dots = c("fy.year", "Sw_amt")) %>% group_by(fy.year) %>% summarise_each(funs(mean))
library(taxstats)
taxstats:::generic_inflator(sample_file_1213, vars = c("Sw_amt", "Taxable_Income"), h = 3L)
vars = c("Sw_amt")
select_which_ <- function(.data, Which, .and.dots){
which <- match.fun(Which)
if (!missing(.and.dots)){
dplyr::select_(.data, .dots = c(names(.data)[sapply(.data, which)] , .and.dots))
} else {
dplyr::select_(.data, .dots = names(.data)[sapply(.data, which)])
}
}
mean_of_each_var <-
sample_files_all %>%
dplyr::select_(.dots = c("fy.year", vars)) %>%
select_which_(is.numeric, "fy.year") %>%
dplyr::group_by(fy.year) %>%
dplyr::summarise_each(dplyr::funs(mean))
mean_of_each_var
library(taxstats)
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Taxable_Income"), h = 3L)
?generic_inflator
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Taxable_Income"), h = 3L)
traceback()
names(sample_files_all)
generic_inflator(sample_file_1213, vars = c("Spouse_adjusted_taxable_inc", "Taxable_Income"), h = 3L)
sample_files_all
sample_files_all %>% dplyr::select_(.dots = c("fy.year", "Sw_amt"))
sample_files_all %>% dplyr::select_(.dots = c("fy.year", "Sw_amt")) %>% select_which_(is.numeric, "fy.year")
sample_files_all %>% dplyr::select_(.dots = c("fy.year", "Sw_amt")) %>% select_which_(is.numeric, "fy.year") %>% group_by(fy.year) %>% summarise_each(funs(mean))
sample_files_all %>% dplyr::select_(.dots = c("fy.year", "Sw_amt")) %>% select_which_(is.numeric, "fy.year") %>% dplyr::group_by(fy.year) %>% dplyr::summarise_each(funs(mean))
sample_files_all %>% dplyr::select_(.dots = c("fy.year", c("Sw_amt"))) %>% select_which_(is.numeric, "fy.year") %>% dplyr::group_by(fy.year) %>% dplyr::summarise_each(funs(mean))
library(taxstats)
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L)
mean_of_each_var
rm(mean_of_each_var)
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L)
.Last.value
mean_of_each_var
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L, nonzero = TRUE)
?dplyr::summarise_each
library(taxstats)
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L, nonzero = TRUE)
rm(list = ls())
sample_files_all
vars = c("Sw_amt", "Taxable_Income")
sample_files_all %>%
dplyr::select_(.dots = c("fy.year", vars)) %>%
select_which_(is.numeric, "fy.year") %>%
dplyr::group_by(fy.year) %>%
dplyr::summarise_each_(funs = dplyr::funs(mean), vars = vars)
select_which_ <- function(.data, Which, .and.dots){
which <- match.fun(Which)
if (!missing(.and.dots)){
dplyr::select_(.data, .dots = c(names(.data)[sapply(.data, which)] , .and.dots))
} else {
dplyr::select_(.data, .dots = names(.data)[sapply(.data, which)])
}
}
sample_files_all %>%
dplyr::select_(.dots = c("fy.year", vars)) %>%
select_which_(is.numeric, "fy.year") %>%
dplyr::group_by(fy.year) %>%
dplyr::summarise_each_(funs = dplyr::funs(mean), vars = vars)
library(taxstats)
taxstats::sample_files_all
library(taxstats)
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L, nonzero = TRUE)
??lazy
lazyLoad(filebase = "sample_files_all", envir = "taxstats")
?lazyLoad
library(taxstats)
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L, nonzero = TRUE)
library(taxstats)
library(taxstats)
?fivenum
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L, nonzero = TRUE)
vars
sample_files_all <- dplyr::select_(sample_files_all, .dots = c("fy.year", vars))
sample_files_all
library(data.table)
generic_inflator(sample_file_1213, vars = c("Sw_amt", "Net_rent_amt"), h = 1L, nonzero = TRUE)
"fy.year" %in% names(sample_files_all)
dplyr::select_vars_(names(sample_files_all), c("fy.year", c("Sw_amt", "Taxable_Income")))
update.packages()
update.packages(ask = FALSE)
library(taxstats)
generic_inflator(sample_file_1213, vars = c("Sw_amt"), h = 2L)
library(taxstats)
generic_inflator(sample_file_1213, vars = c("Sw_amt"), h = 2L)
taxstats:::generic_inflator(sample_file_1213, vars = c("Sw_amt"), h = 2L)
generic_inflator
library(taxstats)
taxstats:::project(sample_file_1213, h = 1L)
library(data.table)
taxstats:::project(sample_file_1213, h = 1L)
taxstats:::project(sample_file_1213, h = 1L)
exit()
library(dplyr)
project(sample_file_1213, 1L)
library(taxstats)
project(sample_file_1213, 1L)
taxstats:::project(sample_file_1213, 1L)
taxstats:::project(sample_file_1213, 1L, WEIGHT = 50L)
sample_file_1213
library(grattan)
sample_file_1213 %>% project(5L)
sample_file_1213 %>% taxstats:::project(5L)
